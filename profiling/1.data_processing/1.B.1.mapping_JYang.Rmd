---
title: "Map scRNA-seq data to maize AGPv5"
author: "Jinliang Yang and subhash"
date: "08-16-2024"
output: NULL
---


# 2.4 Data analysis of scRNA-seq of Maize
- text below is copied from the Li et al., 2022 paper

To generate the gene expression matrix of single cells, the raw reads were aligned to the B73 reference genome, and gene expression was quantified using the `Cell Ranger pipeline (version 3.1, 10X Genomics)`. 
The B73 reference genome and annotation files were downloaded from Ensembl (ftp://ftp.ensemblgenomes.org/ pub/plants/release-42). The gene annotation (gtf) file was filtered by the `cellranger mkgtf` function with the `--attribute = gene_bio type: protein_coding` argument. 
The `cellranger mkref` function of Cell Ranger was used to build a reference. The `cellranger count` function was performed to generate a raw count matrix.

# Cell Ranger installation

here is the [tutorials](https://www.10xgenomics.com/support/software/cell-ranger/latest/tutorials)

```{bash}
cd ~/bin/
wget -O cellranger-8.0.1.tar.gz "https://cf.10xgenomics.com/releases/cell-exp/cellranger-8.0.1.tar.gz?Expires=1723872327&Key-Pair-Id=APKAI7S6A5RYOXBWRPDA&Signature=QMT75~0APN1ylbKNNePQ6cVDlqqkgCAwzdCcX5lsc5v5QBJsMw48x4UHPYJcu8TYRJO7JF1EUkZnrQgNDae8qsUY~~wOLxckFia4gw1chgDOfW96J9ylhpNN0lOaXUy8deeiogn0NFoFMPPX67V-VjZWyJ6vo5hlySaT58sgewghGZPePoJIWXR~o78f1I7AIqOg8gQaP7AfDXROWxcd3nZTswklG1BAmRDMYQnB0zEGYYgvTxjEYDHUpjk3cuE5o7Uz0bldY9Cvw4TF~JdaXEPvH2HsTBBM~7-gZ~AlM4AwWwIM48wxAaHLR8BAxVztpSH~Kv9ftk4DJEk8rAKSjA__"

tar -xvzf cellranger-8.0.1.tar.g

#export your path to .bashrc or .bash_profile

cellranger testrun --id=check_install

# if install successfully, you should get the below info:
```

Waiting 6 seconds for UI to do final refresh.
Pipestance completed successfully!

2024-08-16 13:49:40 Shutting down.
Saving pipestance info to "check_install/check_install.mri.tgz"

# Prepare the gene annotation file

https://www.maizegdb.org/genome/assembly/Zm-B73-REFERENCE-NAM-5.0

```{bash}
# get the reference genome and annotations
wget https://download.maizegdb.org/Zm-B73-REFERENCE-NAM-5.0/Zm-B73-REFERENCE-NAM-5.0.fa.gz
gzip -d Zm-B73-REFERENCE-NAM-5.0.fa.gz

wget https://download.maizegdb.org/Zm-B73-REFERENCE-NAM-5.0/Zm-B73-REFERENCE-NAM-5.0_Zm00001eb.1.gff3.gz
gzip -d Zm-B73-REFERENCE-NAM-5.0_Zm00001eb.1.gff3.gz
```

# Maize GFF file


```{bash}
cellranger mkgtf -h
cellranger mkgtf Zm-B73-REFERENCE-NAM-5.0_Zm00001eb.1.gff3 Zm-B73-REFERENCE-NAM-5.0_gene.gtf --attribute = gene
```



